window.DebugPanel={logs:[],maxLogs:50,enabled:localStorage.getItem('debug_enabled')==='true',init(){if(!this.enabled)return;const panel=document.createElement('div');panel.id='debug-panel';panel.innerHTML=`<div style="position:fixed;bottom:0;right:0;width:400px;max-height:300px;background:#1a1a1a;color:#0f0;font-family:monospace;font-size:11px;border:1px solid #0f0;z-index:99999;overflow:hidden;display:flex;flex-direction:column;"><div style="padding:5px;background:#000;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #0f0;"><span>üêõ DEBUG</span><div><button onclick="DebugPanel.clear()" style="background:#333;color:#0f0;border:1px solid #0f0;padding:2px 8px;margin-right:5px;cursor:pointer;">Clear</button><button onclick="DebugPanel.toggle()" style="background:#333;color:#0f0;border:1px solid #0f0;padding:2px 8px;cursor:pointer;">Hide</button></div></div><div id="debug-logs" style="flex:1;overflow-y:auto;padding:5px;"></div></div>`;document.body.appendChild(panel);this.interceptFetch()},toggle(){this.enabled=!this.enabled;localStorage.setItem('debug_enabled',this.enabled);const panel=document.getElementById('debug-panel');if(panel)panel.style.display=this.enabled?'flex':'none'},clear(){this.logs=[];const logsEl=document.getElementById('debug-logs');if(logsEl)logsEl.innerHTML=''},log(type,message,data){if(!this.enabled)return;const timestamp=new Date().toLocaleTimeString();const colors={request:'#00f',success:'#0f0',error:'#f00',info:'#ff0'};const log={timestamp,type,message,data};this.logs.unshift(log);if(this.logs.length>this.maxLogs)this.logs.pop();const logsEl=document.getElementById('debug-logs');if(!logsEl)return;const logEl=document.createElement('div');logEl.style.cssText=`padding:3px 0;border-bottom:1px solid #333;color:${colors[type]||'#0f0'}`;logEl.innerHTML=`<div><strong>${timestamp}</strong> [${type.toUpperCase()}]</div><div style="color:#aaa;">${message}</div>`;if(data){const dataEl=document.createElement('pre');dataEl.style.cssText='margin:2px 0;color:#888;font-size:10px;white-space:pre-wrap;';dataEl.textContent=JSON.stringify(data,null,2).substring(0,200);logEl.appendChild(dataEl)}logsEl.insertBefore(logEl,logsEl.firstChild);while(logsEl.children.length>20){logsEl.removeChild(logsEl.lastChild)}},interceptFetch(){const originalFetch=window.fetch;window.fetch=async(...args)=>{const[url,options]=args;const method=options?.method||'GET';const startTime=Date.now();this.log('request',`${method} ${url}`);try{const response=await originalFetch(...args);const duration=Date.now()-startTime;const clone=response.clone();if(response.ok){try{const data=await clone.json();this.log('success',`${method} ${url} (${duration}ms)`,{status:response.status,data})}catch{this.log('success',`${method} ${url} (${duration}ms)`,{status:response.status})}}else{try{const error=await clone.json();this.log('error',`${method} ${url} (${duration}ms)`,{status:response.status,error})}catch{this.log('error',`${method} ${url} (${duration}ms)`,{status:response.status})}}return response}catch(error){const duration=Date.now()-startTime;this.log('error',`${method} ${url} FAILED (${duration}ms)`,{error:error.message});throw error}}}};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>DebugPanel.init())}else{DebugPanel.init()}document.addEventListener('keydown',(e)=>{if(e.ctrlKey&&e.shiftKey&&e.key==='D'){e.preventDefault();DebugPanel.toggle()}});
