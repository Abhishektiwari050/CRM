window.DebugPanel={logs:[],maxLogs:50,enabled:true,init(){const panel=document.createElement('div');panel.id='debug-panel';panel.innerHTML=`<div style="position:fixed;top:10px;right:10px;width:350px;max-height:400px;background:#1a1a1a;color:#0f0;font-family:monospace;font-size:10px;border:2px solid #0f0;z-index:99999;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 4px 20px rgba(0,255,0,0.3);"><div style="padding:5px;background:#000;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #0f0;"><span>üêõ API LOG</span><button onclick="DebugPanel.clear()" style="background:#333;color:#0f0;border:1px solid #0f0;padding:2px 8px;cursor:pointer;font-size:10px;">Clear</button></div><div id="debug-logs" style="flex:1;overflow-y:auto;padding:5px;"></div></div>`;document.body.appendChild(panel);this.interceptFetch()},clear(){this.logs=[];const logsEl=document.getElementById('debug-logs');if(logsEl)logsEl.innerHTML=''},log(type,message,data){const timestamp=new Date().toLocaleTimeString();const colors={request:'#00f',success:'#0f0',error:'#f00',info:'#ff0'};const log={timestamp,type,message,data};this.logs.unshift(log);if(this.logs.length>this.maxLogs)this.logs.pop();const logsEl=document.getElementById('debug-logs');if(!logsEl)return;const logEl=document.createElement('div');logEl.style.cssText=`padding:3px 0;border-bottom:1px solid #333;color:${colors[type]||'#0f0'}`;logEl.innerHTML=`<div><strong>${timestamp}</strong> [${type.toUpperCase()}]</div><div style="color:#aaa;">${message}</div>`;if(data){const dataEl=document.createElement('pre');dataEl.style.cssText='margin:2px 0;color:#888;font-size:9px;white-space:pre-wrap;max-height:100px;overflow:auto;';dataEl.textContent=JSON.stringify(data,null,2).substring(0,300);logEl.appendChild(dataEl)}logsEl.insertBefore(logEl,logsEl.firstChild);while(logsEl.children.length>15){logsEl.removeChild(logsEl.lastChild)}},interceptFetch(){const originalFetch=window.fetch;window.fetch=async(...args)=>{const[url,options]=args;const method=options?.method||'GET';const startTime=Date.now();this.log('request',`${method} ${url}`);try{const response=await originalFetch(...args);const duration=Date.now()-startTime;const clone=response.clone();if(response.ok){try{const data=await clone.json();this.log('success',`${method} ${url} (${duration}ms)`,{status:response.status,data})}catch{this.log('success',`${method} ${url} (${duration}ms)`,{status:response.status})}}else{try{const error=await clone.json();this.log('error',`${method} ${url} (${duration}ms)`,{status:response.status,error})}catch{this.log('error',`${method} ${url} (${duration}ms)`,{status:response.status})}}return response}catch(error){const duration=Date.now()-startTime;this.log('error',`${method} ${url} FAILED (${duration}ms)`,{error:error.message});throw error}}}};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>DebugPanel.init())}else{DebugPanel.init()}
